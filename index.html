<html lang="ru"><head>
<meta charset="UTF-8">
<title>UX-тест навигации ассортимента</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f5f5f5}
header{background:#2f2f2f;color:#fff;padding:14px 16px;font-size:18px}
.controls{background:#fff;padding:10px 16px;border-bottom:1px solid #ddd;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.container{padding:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
.item{background:#fff;border-radius:10px;padding:16px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,.08)}
.folder{cursor:pointer;background:#f0f8ff;font-weight:bold}
.product{background:#fffbe6;cursor:pointer}
.path{padding:10px 16px;background:#fafafa;border-bottom:1px solid #ddd}
.path span{color:#0077cc;cursor:pointer}
button,input{padding:6px 10px}
.test-box{padding:12px 16px;background:#e8f4ff;border-bottom:1px solid #cce}
.alert-wrong{background:#ffe8e8;color:#a00;padding:10px 16px}
#resultScreen{padding:16px}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{border:1px solid #ddd;padding:8px}
th{background:#f0f0f0}
.kpi-ok{color:green;font-weight:bold}
.kpi-fail{color:red;font-weight:bold}
</style>
<script>
const __STANDALONE_TREE__={"Сладкая":{"name":"Сладкая","type":"folder","children":{"*-Витушка сдобная с изюмом и шоколадом КБ":{"name":"*-Витушка сдобная с изюмом и шоколадом КБ","type":"item","children":{}},"*-Витушка сдобная с малиной КБ":{"name":"*-Витушка сдобная с малиной КБ","type":"item","children":{}},"-Булочка красный бархат КБ":{"name":"-Булочка красный бархат КБ","type":"item","children":{}},"-Булочка-чизкейк КБ":{"name":"-Булочка-чизкейк КБ","type":"item","children":{}},"-Вензель вишня КБ":{"name":"-Вензель вишня КБ","type":"item","children":{}},"-Вензель малина КБ":{"name":"-Вензель малина КБ","type":"item","children":{}},"-Витушка с маком и шоколадом КБ":{"name":"-Витушка с маком и шоколадом КБ","type":"item","children":{}},"-Кенигсбергская булочка с клюквой КБ":{"name":"-Кенигсбергская булочка с клюквой КБ","type":"item","children":{}},"-Кранч с маком КБ":{"name":"-Кранч с маком КБ","type":"item","children":{}},"-Кранч с маком,1/2  КБ":{"name":"-Кранч с маком,1/2  КБ","type":"item","children":{}},"Крендель с корицей КБ":{"name":"Крендель с корицей КБ","type":"item","children":{}},"Крендель с маком КБ":{"name":"Крендель с маком КБ","type":"item","children":{}},"-Круассан классический КБ":{"name":"-Круассан классический КБ","type":"item","children":{}},"-Круассан с вишней КБ":{"name":"-Круассан с вишней КБ","type":"item","children":{}},"-Круассан с шоколадом КБ":{"name":"-Круассан с шоколадом КБ","type":"item","children":{}},"-Печенье Овсяное с изюмом  КБ":{"name":"-Печенье Овсяное с изюмом  КБ","type":"item","children":{}},"-Печенье с шоколадом КБ":{"name":"-Печенье с шоколадом КБ","type":"item","children":{}},"-Португальская корзиночка 50гр КБ":{"name":"-Португальская корзиночка 50гр КБ","type":"item","children":{}},"-Слойка с вишней КБ":{"name":"-Слойка с вишней КБ","type":"item","children":{}},"-Слойка с творогом КБ":{"name":"-Слойка с творогом КБ","type":"item","children":{}},"-Слойка с черемухой КБ":{"name":"-Слойка с черемухой КБ","type":"item","children":{}},"-Слойка с шоколадом и заварным кремом КБ":{"name":"-Слойка с шоколадом и заварным кремом КБ","type":"item","children":{}},"-Слойка-витушка с изюмом КБ":{"name":"-Слойка-витушка с изюмом КБ","type":"item","children":{}},"-Слойка-витушка с корицей КБ":{"name":"-Слойка-витушка с корицей КБ","type":"item","children":{}},"-Сочник с творогом КБ":{"name":"-Сочник с творогом КБ","type":"item","children":{}},"-Целый штрудель с маком и вишней КБ":{"name":"-Целый штрудель с маком и вишней КБ","type":"item","children":{}},"-Шассон КБ":{"name":"-Шассон КБ","type":"item","children":{}},"-Штрудель с маком и вишней-порция КБ":{"name":"-Штрудель с маком и вишней-порция КБ","type":"item","children":{}}}},"Кондитерка":{"name":"Кондитерка","type":"folder","children":{"Пирожное":{"name":"Пирожное","type":"folder","children":{"*-Наполеон КБ":{"name":"*-Наполеон КБ","type":"item","children":{}},"-Кольцо творожное КБ":{"name":"-Кольцо творожное КБ","type":"item","children":{}},"-Лапка КБ":{"name":"-Лапка КБ","type":"item","children":{}},"-Муравейка КБ":{"name":"-Муравейка КБ","type":"item","children":{}},"-Панна-котта манго-маракуйя КБ":{"name":"-Панна-котта манго-маракуйя КБ","type":"item","children":{}},"-Пирожное Картошка КБ":{"name":"-Пирожное Картошка КБ","type":"item","children":{}},"-Пирожное Медовое КБ":{"name":"-Пирожное Медовое КБ","type":"item","children":{}},"-Пирожное Сникерс КБ":{"name":"-Пирожное Сникерс КБ","type":"item","children":{}},"-Тарталетка Гренобль КБ":{"name":"-Тарталетка Гренобль КБ","type":"item","children":{}},"-Тарталетка лимонная КБ":{"name":"-Тарталетка лимонная КБ","type":"item","children":{}},"-Тарталетка с вишней КБ":{"name":"-Тарталетка с вишней КБ","type":"item","children":{}},"-Тирамису КБ":{"name":"-Тирамису КБ","type":"item","children":{}},"-Шу сметанный КБ":{"name":"-Шу сметанный КБ","type":"item","children":{}},"-Шу со сметаной и малиной КБ":{"name":"-Шу со сметаной и малиной КБ","type":"item","children":{}},"-Эклер Соленая карамель КБ":{"name":"-Эклер Соленая карамель КБ","type":"item","children":{}}}},"Пирог/Чизкейк":{"name":"Пирог/Чизкейк","type":"folder","children":{"-Апельсиновый чизкейк КБ":{"name":"-Апельсиновый чизкейк КБ","type":"item","children":{}},"-Апельсиновый чизкейк-порция 1/10 КБ":{"name":"-Апельсиновый чизкейк-порция 1/10 КБ","type":"item","children":{}},"-Пирог с малиной КБ":{"name":"-Пирог с малиной КБ","type":"item","children":{}},"-Целый чизкейк шоколадный КБ":{"name":"-Целый чизкейк шоколадный КБ","type":"item","children":{}},"-Чизкейк шоколадный - порция 1/10 КБ":{"name":"-Чизкейк шоколадный - порция 1/10 КБ","type":"item","children":{}}}},"Торт":{"name":"Торт","type":"folder","children":{"-Торт Медовый Круглый КБ":{"name":"-Торт Медовый Круглый КБ","type":"item","children":{}},"-Торт Панчо круглый КБ":{"name":"-Торт Панчо круглый КБ","type":"item","children":{}},"-Торт Птичка КБ":{"name":"-Торт Птичка КБ","type":"item","children":{}},"-Торт Сникерс круглый КБ":{"name":"-Торт Сникерс круглый КБ","type":"item","children":{}}}}}},"Сытная":{"name":"Сытная","type":"folder","children":{"-Багет с индейкой КБ":{"name":"-Багет с индейкой КБ","type":"item","children":{}},"-Бейгл с тунцом КБ":{"name":"-Бейгл с тунцом КБ","type":"item","children":{}},"-Испанский пирожок с капустой и яйцом КБ":{"name":"-Испанский пирожок с капустой и яйцом КБ","type":"item","children":{}},"-Испанский пирожок с картофелем и грибами КБ":{"name":"-Испанский пирожок с картофелем и грибами КБ","type":"item","children":{}},"-Испанский пирожок с курицей КБ":{"name":"-Испанский пирожок с курицей КБ","type":"item","children":{}},"-Киш с курицей и грибами 1/8 КБ":{"name":"-Киш с курицей и грибами 1/8 КБ","type":"item","children":{}},"-Киш с курицей и грибами КБ":{"name":"-Киш с курицей и грибами КБ","type":"item","children":{}},"-Киш с лососем, треской и брокколи 1/8 КБ":{"name":"-Киш с лососем, треской и брокколи 1/8 КБ","type":"item","children":{}},"-Киш с лососем, треской и брокколи КБ":{"name":"-Киш с лососем, треской и брокколи КБ","type":"item","children":{}},"-Круассан с лососем КБ":{"name":"-Круассан с лососем КБ","type":"item","children":{}},"-Круассан Цезарь с копченой курицей КБ":{"name":"-Круассан Цезарь с копченой курицей КБ","type":"item","children":{}},"-Палочка сырная Маргарита КБ":{"name":"-Палочка сырная Маргарита КБ","type":"item","children":{}},"-Палочка сырная шпинат-грибы КБ":{"name":"-Палочка сырная шпинат-грибы КБ","type":"item","children":{}},"-Слойка с сыром и ветчиной КБ":{"name":"-Слойка с сыром и ветчиной КБ","type":"item","children":{}},"-Слойка со шпинатом, яйцом и сыром КБ":{"name":"-Слойка со шпинатом, яйцом и сыром КБ","type":"item","children":{}},"-Сосиска в тесте КБ":{"name":"-Сосиска в тесте КБ","type":"item","children":{}},"-Сэндвич с яичной пастой и копчёным лососем КБ":{"name":"-Сэндвич с яичной пастой и копчёным лососем КБ","type":"item","children":{}},"-Хачапури фирменный КБ":{"name":"-Хачапури фирменный КБ","type":"item","children":{}},"-Чиабатта с салями и пеперони КБ":{"name":"-Чиабатта с салями и пеперони КБ","type":"item","children":{}}}},"Ланчи/Завтраки":{"name":"Ланчи/Завтраки","type":"folder","children":{"Понедельник":{"name":"Понедельник","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Запеканка с брокколи и адыгейским сыром КБ":{"name":"-Запеканка с брокколи и адыгейским сыром КБ","type":"item","children":{}},"Каша рисовая с вишней КБ":{"name":"Каша рисовая с вишней КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Котлета домашняя с рисом с овощами и грибным соусом упак КБ":{"name":"-Котлета домашняя с рисом с овощами и грибным соусом упак КБ","type":"item","children":{}},"-Шницель куриный с гречкой КБ":{"name":"-Шницель куриный с гречкой КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат с курицей, моцареллой и овощами-КБ":{"name":"-Салат с курицей, моцареллой и овощами-КБ","type":"item","children":{}},"-Салат с тунцом и рисом - КБ":{"name":"-Салат с тунцом и рисом - КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп куриный с домашней лапшой КБ":{"name":"-Суп куриный с домашней лапшой КБ","type":"item","children":{}}}}}},"Вторник":{"name":"Вторник","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Блины с маком и вишней КБ":{"name":"-Блины с маком и вишней КБ","type":"item","children":{}},"-Пшенная каша с яблоком и корицей КБ":{"name":"-Пшенная каша с яблоком и корицей КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Зразы картофельные с мясом и грибным соусом КБ":{"name":"-Зразы картофельные с мясом и грибным соусом КБ","type":"item","children":{}},"-Куриное бедро в сладком соусе с рисом и кунжутом - КБ":{"name":"-Куриное бедро в сладком соусе с рисом и кунжутом - КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат Оливье с ветчиной- КБ":{"name":"-Салат Оливье с ветчиной- КБ","type":"item","children":{}},"-Салат персидский с кускусом КБ":{"name":"-Салат персидский с кускусом КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп сырный с клецками КБ":{"name":"-Суп сырный с клецками КБ","type":"item","children":{}}}}}},"Среда":{"name":"Среда","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Запеканка творожная с яблоком и корицей-КБ":{"name":"-Запеканка творожная с яблоком и корицей-КБ","type":"item","children":{}},"-Каша овсяная с маком-КБ":{"name":"-Каша овсяная с маком-КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Котлета пожарская с картофельным пюре и грибным соусом КБ":{"name":"-Котлета пожарская с картофельным пюре и грибным соусом КБ","type":"item","children":{}},"-Тайский рис с курицей КБ":{"name":"-Тайский рис с курицей КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат Венеция-КБ":{"name":"-Салат Венеция-КБ","type":"item","children":{}},"-Салат овощной с брынзой- КБ":{"name":"-Салат овощной с брынзой- КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп Щи КБ":{"name":"-Суп Щи КБ","type":"item","children":{}}}}}},"Четверг":{"name":"Четверг","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Блинчики яблоко с изюмом КБ":{"name":"-Блинчики яблоко с изюмом КБ","type":"item","children":{}},"-Каша кукурузная с халвой КБ":{"name":"-Каша кукурузная с халвой КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Индейка с овощами в сливочно-сырном соусе и птитим-КБ":{"name":"-Индейка с овощами в сливочно-сырном соусе и птитим-КБ","type":"item","children":{}},"-Шницель из свинины с картофельным пюре - КБ":{"name":"-Шницель из свинины с картофельным пюре - КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат Метелка-КБ":{"name":"-Салат Метелка-КБ","type":"item","children":{}},"-Салат Фунчоза с курицей КБ":{"name":"-Салат Фунчоза с курицей КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп грибной с булгуром КБ":{"name":"-Суп грибной с булгуром КБ","type":"item","children":{}}}}}},"Пятница":{"name":"Пятница","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Каша 5 злаков на миндальном молоке-КБ":{"name":"-Каша 5 злаков на миндальном молоке-КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}},"-Хашбраун с курицей и грибами-КБ":{"name":"-Хашбраун с курицей и грибами-КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Колбаска с тушеной капустой и картофельным пюре упак КБ":{"name":"-Колбаска с тушеной капустой и картофельным пюре упак КБ","type":"item","children":{}},"-Курица в грибном соусе с пастой фузилли упак КБ":{"name":"-Курица в грибном соусе с пастой фузилли упак КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат мимоза-КБ":{"name":"-Салат мимоза-КБ","type":"item","children":{}},"-Салат с курицей и грибами-КБ":{"name":"-Салат с курицей и грибами-КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп Борщ с курицей -КБ":{"name":"-Суп Борщ с курицей -КБ","type":"item","children":{}}}}}},"Суббота":{"name":"Суббота","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Блины с маком и вишней КБ":{"name":"-Блины с маком и вишней КБ","type":"item","children":{}},"-Пшенная каша с яблоком и корицей КБ":{"name":"-Пшенная каша с яблоком и корицей КБ","type":"item","children":{}},"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{"-Зразы картофельные с мясом и грибным соусом КБ":{"name":"-Зразы картофельные с мясом и грибным соусом КБ","type":"item","children":{}},"-Куриное бедро в сладком соусе с рисом и кунжутом - КБ":{"name":"-Куриное бедро в сладком соусе с рисом и кунжутом - КБ","type":"item","children":{}}}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}},"-Салат Оливье с ветчиной- КБ":{"name":"-Салат Оливье с ветчиной- КБ","type":"item","children":{}},"-Салат персидский с кускусом КБ":{"name":"-Салат персидский с кускусом КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{"-Суп сырный с клецками КБ":{"name":"-Суп сырный с клецками КБ","type":"item","children":{}}}}}},"Воскресенье":{"name":"Воскресенье","type":"folder","children":{"Завтрак":{"name":"Завтрак","type":"folder","children":{"-Сырник 1 шт КБ":{"name":"-Сырник 1 шт КБ","type":"item","children":{}}}},"Горячее":{"name":"Горячее","type":"folder","children":{}},"Салат":{"name":"Салат","type":"folder","children":{"-Боул с креветкой-КБ":{"name":"-Боул с креветкой-КБ","type":"item","children":{}},"-Боул с курицей - КБ":{"name":"-Боул с курицей - КБ","type":"item","children":{}}}},"Суп":{"name":"Суп","type":"folder","children":{}}}}}},"Напитки":{"name":"Напитки","type":"folder","children":{"Вода":{"name":"Вода","type":"folder","children":{"Вода газ Янтарный Айсберг 0,5 пэт":{"name":"Вода газ Янтарный Айсберг 0,5 пэт","type":"item","children":{}},"Вода н/газ Янтарный Айсберг 0,5 пэт":{"name":"Вода н/газ Янтарный Айсберг 0,5 пэт","type":"item","children":{}}}},"Какао":{"name":"Какао","type":"folder","children":{"Обычное молоко":{"name":"Обычное молоко","type":"folder","children":{"КР Детский  какао 0,2 КБ":{"name":"КР Детский  какао 0,2 КБ","type":"item","children":{}},"КР Какао  0,4 л КБ":{"name":"КР Какао  0,4 л КБ","type":"item","children":{}},"КР Какао 0,2 л КБ":{"name":"КР Какао 0,2 л КБ","type":"item","children":{}},"КР Какао 0,3 л КБ":{"name":"КР Какао 0,3 л КБ","type":"item","children":{}},"Сливочно-ореховый какао 300мл КБ":{"name":"Сливочно-ореховый какао 300мл КБ","type":"item","children":{}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"- Маршмеллоу КБ":{"name":"- Маршмеллоу КБ","type":"item","children":{}},"-Стружка шоколадная 50 г. КБ":{"name":"-Стружка шоколадная 50 г. КБ","type":"item","children":{}}}}}},"Растительное молоко":{"name":"Растительное молоко","type":"folder","children":{"Какао большой на растит молоке 0,4 л  КБ":{"name":"Какао большой на растит молоке 0,4 л  КБ","type":"item","children":{}},"Какао маленький на растит молоке 0,2 л  КБ":{"name":"Какао маленький на растит молоке 0,2 л  КБ","type":"item","children":{}},"Какао средний на растит молоке 0,3 л  КБ":{"name":"Какао средний на растит молоке 0,3 л  КБ","type":"item","children":{}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"- Маршмеллоу КБ":{"name":"- Маршмеллоу КБ","type":"item","children":{}},"-Стружка шоколадная 50 г. КБ":{"name":"-Стружка шоколадная 50 г. КБ","type":"item","children":{}}}}}}}},"Кофе":{"name":"Кофе","type":"folder","children":{"Авторский":{"name":"Авторский","type":"folder","children":{"Айс латте КБ ":{"name":"Айс латте КБ ","type":"item","children":{}},"Бамбл кофе КБ":{"name":"Бамбл кофе КБ","type":"item","children":{}},"Карамельный раф 0,3 л КБ":{"name":"Карамельный раф 0,3 л КБ","type":"item","children":{}},"Классический раф 0,3 л КБ":{"name":"Классический раф 0,3 л КБ","type":"item","children":{}},"Латте лавандовый мед КБ":{"name":"Латте лавандовый мед КБ","type":"item","children":{}},"Латте мята-карамель 0,3 л КБ":{"name":"Латте мята-карамель 0,3 л КБ","type":"item","children":{}},"Латте Тоффи -фундук  КБ":{"name":"Латте Тоффи -фундук  КБ","type":"item","children":{}},"Латте фисташка с шоколадной крошкой КБ":{"name":"Латте фисташка с шоколадной крошкой КБ","type":"item","children":{}},"Матча-латте 0,2 л КБ":{"name":"Матча-латте 0,2 л КБ","type":"item","children":{}},"Раф клубничный пломбир 0,3 л КБ":{"name":"Раф клубничный пломбир 0,3 л КБ","type":"item","children":{}},"Раф лавандовый мед КБ":{"name":"Раф лавандовый мед КБ","type":"item","children":{}}}},"Обычное молоко":{"name":"Обычное молоко","type":"folder","children":{"КР Американо 0,2 л КБ":{"name":"КР Американо 0,2 л КБ","type":"item","children":{}},"КР Американо 0,3 л КБ":{"name":"КР Американо 0,3 л КБ","type":"item","children":{}},"КР Капучино 0,2 л КБ":{"name":"КР Капучино 0,2 л КБ","type":"item","children":{}},"КР Капучино 0,3 л КБ":{"name":"КР Капучино 0,3 л КБ","type":"item","children":{}},"КР Капучино 0,4 л КБ":{"name":"КР Капучино 0,4 л КБ","type":"item","children":{}},"КР Латте 0,2 л КБ":{"name":"КР Латте 0,2 л КБ","type":"item","children":{}},"КР Латте 0,3 л КБ":{"name":"КР Латте 0,3 л КБ","type":"item","children":{}},"КР Латте 0,4 л КБ":{"name":"КР Латте 0,4 л КБ","type":"item","children":{}},"КР Флэт-вайт КБ":{"name":"КР Флэт-вайт КБ","type":"item","children":{}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"-Корица  КБ":{"name":"-Корица  КБ","type":"item","children":{}},"- Маршмеллоу КБ":{"name":"- Маршмеллоу КБ","type":"item","children":{}},"-Стружка шоколадная 50 г. КБ":{"name":"-Стружка шоколадная 50 г. КБ","type":"item","children":{}},"Сироп":{"name":"Сироп","type":"folder","children":{"Сироп Амаретто КБ":{"name":"Сироп Амаретто КБ","type":"item","children":{}},"Сироп Ваниль  КБ":{"name":"Сироп Ваниль  КБ","type":"item","children":{}},"Сироп Карамель  КБ":{"name":"Сироп Карамель  КБ","type":"item","children":{}},"Сироп Клубника КБ":{"name":"Сироп Клубника КБ","type":"item","children":{}},"Сироп Кокос  КБ":{"name":"Сироп Кокос  КБ","type":"item","children":{}},"Сироп Лесной орех  КБ":{"name":"Сироп Лесной орех  КБ","type":"item","children":{}},"Сироп Миндаль КБ":{"name":"Сироп Миндаль КБ","type":"item","children":{}},"Сироп Мята зеленая КБ":{"name":"Сироп Мята зеленая КБ","type":"item","children":{}},"Сироп Соленая карамель КБ":{"name":"Сироп Соленая карамель КБ","type":"item","children":{}}}}}}}},"Растительное молоко":{"name":"Растительное молоко","type":"folder","children":{"КР Капучино на растит молоке 0,2 л  КБ":{"name":"КР Капучино на растит молоке 0,2 л  КБ","type":"item","children":{}},"КР Капучино на растит молоке 0,3 л  КБ":{"name":"КР Капучино на растит молоке 0,3 л  КБ","type":"item","children":{}},"КР Капучино на растит молоке 0,4 л  КБ":{"name":"КР Капучино на растит молоке 0,4 л  КБ","type":"item","children":{}},"КР Латте на растит молоке 0,2 л КБ":{"name":"КР Латте на растит молоке 0,2 л КБ","type":"item","children":{}},"КР Латте на растит молоке 0,3 л КБ":{"name":"КР Латте на растит молоке 0,3 л КБ","type":"item","children":{}},"КР Латте на растит молоке 0,4 л КБ":{"name":"КР Латте на растит молоке 0,4 л КБ","type":"item","children":{}},"КР Флэт-вайт на растит молоке  КБ ":{"name":"КР Флэт-вайт на растит молоке  КБ ","type":"item","children":{}},"Латте - Тоффи - фундук на растительном молоке  0,3 л  КБ":{"name":"Латте - Тоффи - фундук на растительном молоке  0,3 л  КБ","type":"item","children":{}},"Матча-латте на растительном молоке 0,2 л  КБ":{"name":"Матча-латте на растительном молоке 0,2 л  КБ","type":"item","children":{}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"-Корица  КБ":{"name":"-Корица  КБ","type":"item","children":{}},"- Маршмеллоу КБ":{"name":"- Маршмеллоу КБ","type":"item","children":{}},"-Стружка шоколадная 50 г. КБ":{"name":"-Стружка шоколадная 50 г. КБ","type":"item","children":{}},"Сироп":{"name":"Сироп","type":"folder","children":{"Сироп Амаретто КБ":{"name":"Сироп Амаретто КБ","type":"item","children":{}},"Сироп Ваниль  КБ":{"name":"Сироп Ваниль  КБ","type":"item","children":{}},"Сироп Карамель  КБ":{"name":"Сироп Карамель  КБ","type":"item","children":{}},"Сироп Клубника КБ":{"name":"Сироп Клубника КБ","type":"item","children":{}},"Сироп Кокос  КБ":{"name":"Сироп Кокос  КБ","type":"item","children":{}},"Сироп Лесной орех  КБ":{"name":"Сироп Лесной орех  КБ","type":"item","children":{}},"Сироп Миндаль КБ":{"name":"Сироп Миндаль КБ","type":"item","children":{}},"Сироп Мята зеленая КБ":{"name":"Сироп Мята зеленая КБ","type":"item","children":{}},"Сироп Соленая карамель КБ":{"name":"Сироп Соленая карамель КБ","type":"item","children":{}}}}}}}}}},"Морс":{"name":"Морс","type":"folder","children":{"-Морс облепиха 300 мл КБ":{"name":"-Морс облепиха 300 мл КБ","type":"item","children":{}},"-Морс черная смородина 300 мл КБ":{"name":"-Морс черная смородина 300 мл КБ","type":"item","children":{}}}},"Чай":{"name":"Чай","type":"folder","children":{"- Напиток Облепиха - имбирь КБ":{"name":"- Напиток Облепиха - имбирь КБ","type":"item","children":{}},"-Чай  КБ":{"name":"-Чай  КБ","type":"item","children":{}},"-Чай гречишный КБ":{"name":"-Чай гречишный КБ","type":"item","children":{}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"-Корица  КБ":{"name":"-Корица  КБ","type":"item","children":{}},"-Лимон  КБ":{"name":"-Лимон  КБ","type":"item","children":{}},"-Мед порция  КБ":{"name":"-Мед порция  КБ","type":"item","children":{}},"Молоко растительное КБ 40 мл.":{"name":"Молоко растительное КБ 40 мл.","type":"item","children":{}},"-Молоко(50мл)  КБ":{"name":"-Молоко(50мл)  КБ","type":"item","children":{}},"-Сливки 30 мл КБ":{"name":"-Сливки 30 мл КБ","type":"item","children":{}},"Сироп":{"name":"Сироп","type":"folder","children":{"Сироп Амаретто КБ":{"name":"Сироп Амаретто КБ","type":"item","children":{}},"Сироп Ваниль  КБ":{"name":"Сироп Ваниль  КБ","type":"item","children":{}},"Сироп Карамель  КБ":{"name":"Сироп Карамель  КБ","type":"item","children":{}},"Сироп Клубника КБ":{"name":"Сироп Клубника КБ","type":"item","children":{}},"Сироп Кокос  КБ":{"name":"Сироп Кокос  КБ","type":"item","children":{}},"Сироп Лесной орех  КБ":{"name":"Сироп Лесной орех  КБ","type":"item","children":{}},"Сироп Миндаль КБ":{"name":"Сироп Миндаль КБ","type":"item","children":{}},"Сироп Мята зеленая КБ":{"name":"Сироп Мята зеленая КБ","type":"item","children":{}},"Сироп Соленая карамель КБ":{"name":"Сироп Соленая карамель КБ","type":"item","children":{}}}}}}}}}},"Хлеб":{"name":"Хлеб","type":"folder","children":{"Багет":{"name":"Багет","type":"folder","children":{"-Багет гречневый СП КБ":{"name":"-Багет гречневый СП КБ","type":"item","children":{}},"-Багет Ржаной зерновой СП КБ":{"name":"-Багет Ржаной зерновой СП КБ","type":"item","children":{}},"-Багет традиционный СП КБ":{"name":"-Багет традиционный СП КБ","type":"item","children":{}}}},"Булочка":{"name":"Булочка","type":"folder","children":{"-Пшеничная булочка КБ":{"name":"-Пшеничная булочка КБ","type":"item","children":{}},"-Ржаная булочка КБ":{"name":"-Ржаная булочка КБ","type":"item","children":{}}}},"Хлеб":{"name":"Хлеб","type":"folder","children":{"Целый":{"name":"Целый","type":"folder","children":{"-Безглютеновый на 5 видах муки КБ":{"name":"-Безглютеновый на 5 видах муки КБ","type":"item","children":{}},"-Хлеб Баварский мультизерновой КБ":{"name":"-Хлеб Баварский мультизерновой КБ","type":"item","children":{}},"-Хлеб Бородинский КБ":{"name":"-Хлеб Бородинский КБ","type":"item","children":{}},"-Хлеб Итальянский пшеничный КБ":{"name":"-Хлеб Итальянский пшеничный КБ","type":"item","children":{}},"-Хлеб Королевский, целый КБ":{"name":"-Хлеб Королевский, целый КБ","type":"item","children":{}},"-Хлеб Отрубной КБ":{"name":"-Хлеб Отрубной КБ","type":"item","children":{}},"-Хлеб Рижский КБ":{"name":"-Хлеб Рижский КБ","type":"item","children":{}},"-Хлеб Сарацин, 315 гр КБ":{"name":"-Хлеб Сарацин, 315 гр КБ","type":"item","children":{}},"-Хлеб Цельнозерновой КБ":{"name":"-Хлеб Цельнозерновой КБ","type":"item","children":{}},"-Хлеб Эстонский КБ":{"name":"-Хлеб Эстонский КБ","type":"item","children":{}},"-Чиабатта пшеничная на закваске СП КБ":{"name":"-Чиабатта пшеничная на закваске СП КБ","type":"item","children":{}}}},"Половина":{"name":"Половина","type":"folder","children":{"-Безглютеновый на 5 видах муки 1/2 КБ":{"name":"-Безглютеновый на 5 видах муки 1/2 КБ","type":"item","children":{}},"-Хлеб Баварский мультизерновой 1/2 КБ":{"name":"-Хлеб Баварский мультизерновой 1/2 КБ","type":"item","children":{}},"-Хлеб Итальянский пшеничный,1/2  КБ":{"name":"-Хлеб Итальянский пшеничный,1/2  КБ","type":"item","children":{}},"-Хлеб Королевский, 1/2 КБ":{"name":"-Хлеб Королевский, 1/2 КБ","type":"item","children":{}},"-Хлеб Рижский 1/2  КБ":{"name":"-Хлеб Рижский 1/2  КБ","type":"item","children":{}},"-Хлеб Цельнозерновой,1/2  КБ":{"name":"-Хлеб Цельнозерновой,1/2  КБ","type":"item","children":{}},"-Хлеб Эстонский  1/2  КБ":{"name":"-Хлеб Эстонский  1/2  КБ","type":"item","children":{}}}}}}}},"Упаковка":{"name":"Упаковка","type":"folder","children":{"Коробка":{"name":"Коробка","type":"folder","children":{"-Д-Коробка 140*140*40 КБ":{"name":"-Д-Коробка 140*140*40 КБ","type":"item","children":{}},"-Д-Коробка 150*150  КБ":{"name":"-Д-Коробка 150*150  КБ","type":"item","children":{}},"-Д-Коробка 150*230  КБ":{"name":"-Д-Коробка 150*230  КБ","type":"item","children":{}},"-Д-Коробка для целых пирогов  КБ":{"name":"-Д-Коробка для целых пирогов  КБ","type":"item","children":{}},"-Д-Коробка для штруделя  КБ":{"name":"-Д-Коробка для штруделя  КБ","type":"item","children":{}},"-Коробка 140*140*40  КБ":{"name":"-Коробка 140*140*40  КБ","type":"item","children":{}},"-Коробка 150*150  КБ":{"name":"-Коробка 150*150  КБ","type":"item","children":{}},"-Коробка 150*230  КБ":{"name":"-Коробка 150*230  КБ","type":"item","children":{}},"-Коробка для ланча ECO OpSalad 350 КБ":{"name":"-Коробка для ланча ECO OpSalad 350 КБ","type":"item","children":{}},"-Коробка для целых пирогов  КБ":{"name":"-Коробка для целых пирогов  КБ","type":"item","children":{}},"-Коробка для штруделя  КБ":{"name":"-Коробка для штруделя  КБ","type":"item","children":{}}}},"Стакан":{"name":"Стакан","type":"folder","children":{"*-Стакан 400 мл PET  КБ":{"name":"*-Стакан 400 мл PET  КБ","type":"item","children":{}},"-Стакан бум.двухслойный 200мл/250мл с логотипом  КБ":{"name":"-Стакан бум.двухслойный 200мл/250мл с логотипом  КБ","type":"item","children":{}},"-Стакан бум.двухслойный 350мл/400мл с логотипом  КБ":{"name":"-Стакан бум.двухслойный 350мл/400мл с логотипом  КБ","type":"item","children":{}},"-Стакан бумажный двухслойный 450/500мл  КБ":{"name":"-Стакан бумажный двухслойный 450/500мл  КБ","type":"item","children":{}}}},"Подставка":{"name":"Подставка","type":"folder","children":{"-Подставка на 2 стакана  КБ":{"name":"-Подставка на 2 стакана  КБ","type":"item","children":{}}}},"Пакет":{"name":"Пакет","type":"folder","children":{"-Д-Пакет п/п под пиццу 285*450  КБ":{"name":"-Д-Пакет п/п под пиццу 285*450  КБ","type":"item","children":{}},"-Д-Пакет-майка 28*50 корона КБ":{"name":"-Д-Пакет-майка 28*50 корона КБ","type":"item","children":{}},"-Пакет бумажный корич с кручен ручками 260*150*350 КБ":{"name":"-Пакет бумажный корич с кручен ручками 260*150*350 КБ","type":"item","children":{}},"-Пакет для багета  КБ":{"name":"-Пакет для багета  КБ","type":"item","children":{}},"-Пакет для выпечки  КБ":{"name":"-Пакет для выпечки  КБ","type":"item","children":{}},"-Пакет для хлеба  КБ":{"name":"-Пакет для хлеба  КБ","type":"item","children":{}},"-Пакет п/п под пиццу 285*450  КБ":{"name":"-Пакет п/п под пиццу 285*450  КБ","type":"item","children":{}},"-Пакет-майка 28*50 корона  КБ":{"name":"-Пакет-майка 28*50 корона  КБ","type":"item","children":{}},"-Пакет-майка ДОСТАВКА КБ":{"name":"-Пакет-майка ДОСТАВКА КБ","type":"item","children":{}}}},"Тарелка/ECO":{"name":"Тарелка/ECO","type":"folder","children":{"-Тарелка бум.14*20  КБ":{"name":"-Тарелка бум.14*20  КБ","type":"item","children":{}},"-Упаковка ЕСО КБ":{"name":"-Упаковка ЕСО КБ","type":"item","children":{}}}}}},"Доп/Поз":{"name":"Доп/Поз","type":"folder","children":{"Сироп":{"name":"Сироп","type":"folder","children":{"Сироп Амаретто КБ":{"name":"Сироп Амаретто КБ","type":"item","children":{}},"Сироп Ваниль  КБ":{"name":"Сироп Ваниль  КБ","type":"item","children":{}},"Сироп Карамель  КБ":{"name":"Сироп Карамель  КБ","type":"item","children":{}},"Сироп Клубника КБ":{"name":"Сироп Клубника КБ","type":"item","children":{}},"Сироп Кокос  КБ":{"name":"Сироп Кокос  КБ","type":"item","children":{}},"Сироп Лесной орех  КБ":{"name":"Сироп Лесной орех  КБ","type":"item","children":{}},"Сироп Миндаль КБ":{"name":"Сироп Миндаль КБ","type":"item","children":{}},"Сироп Мята зеленая КБ":{"name":"Сироп Мята зеленая КБ","type":"item","children":{}},"Сироп Соленая карамель КБ":{"name":"Сироп Соленая карамель КБ","type":"item","children":{}}}},"К кофе/чаю":{"name":"К кофе/чаю","type":"folder","children":{"-Корица  КБ":{"name":"-Корица  КБ","type":"item","children":{}},"-Лимон  КБ":{"name":"-Лимон  КБ","type":"item","children":{}},"- Маршмеллоу КБ":{"name":"- Маршмеллоу КБ","type":"item","children":{}},"-Мед порция  КБ":{"name":"-Мед порция  КБ","type":"item","children":{}},"Молоко растительное КБ 40 мл.":{"name":"Молоко растительное КБ 40 мл.","type":"item","children":{}},"-Молоко стакан  КБ":{"name":"-Молоко стакан  КБ","type":"item","children":{}},"-Молоко(50мл)  КБ":{"name":"-Молоко(50мл)  КБ","type":"item","children":{}},"-Сливки 30 мл КБ":{"name":"-Сливки 30 мл КБ","type":"item","children":{}},"-Стружка шоколадная 50 г. КБ":{"name":"-Стружка шоколадная 50 г. КБ","type":"item","children":{}}}},"Соус":{"name":"Соус","type":"folder","children":{"-Сметана КБ":{"name":"-Сметана КБ","type":"item","children":{}},"-Соус вишневый КБ":{"name":"-Соус вишневый КБ","type":"item","children":{}},"-Соус малиновый КБ":{"name":"-Соус малиновый КБ","type":"item","children":{}}}}}},"Пачка/Кофе":{"name":"Пачка/Кофе","type":"folder","children":{"Кофе в зернах":{"name":"Кофе в зернах","type":"folder","children":{"-Бразилия Декаф в зернах 200гр КБ":{"name":"-Бразилия Декаф в зернах 200гр КБ","type":"item","children":{}},"-Бразилия Феникс в зернах 200гр КБ":{"name":"-Бразилия Феникс в зернах 200гр КБ","type":"item","children":{}},"-Колумбия Андино в зернах 200гр КБ":{"name":"-Колумбия Андино в зернах 200гр КБ","type":"item","children":{}},"-Эспрессо-смесь Konigsbacker в зернах, 200гр КБ":{"name":"-Эспрессо-смесь Konigsbacker в зернах, 200гр КБ","type":"item","children":{}}}},"Кофе молотый":{"name":"Кофе молотый","type":"folder","children":{"-Кофе Бразилия Декаф молотый, 200гр КБ":{"name":"-Кофе Бразилия Декаф молотый, 200гр КБ","type":"item","children":{}},"-Кофе Бразилия Феникс молотый, 200гр КБ":{"name":"-Кофе Бразилия Феникс молотый, 200гр КБ","type":"item","children":{}},"-Кофе Колумбия Андино молотый, 200гр КБ":{"name":"-Кофе Колумбия Андино молотый, 200гр КБ","type":"item","children":{}},"-Кофе молотый Булочка с корицей , 125 гр. КБ":{"name":"-Кофе молотый Булочка с корицей , 125 гр. КБ","type":"item","children":{}},"-Кофе молотый Марципан, 125 гр. КБ":{"name":"-Кофе молотый Марципан, 125 гр. КБ","type":"item","children":{}},"-Кофе молотый Северная вишня, 125 гр. КБ":{"name":"-Кофе молотый Северная вишня, 125 гр. КБ","type":"item","children":{}},"-Эспрессо-смесь Konigsbacker молотый, 200гр КБ":{"name":"-Эспрессо-смесь Konigsbacker молотый, 200гр КБ","type":"item","children":{}}}}}},"Сувениры/Услуги/Заказы":{"name":"Сувениры/Услуги/Заказы","type":"folder","children":{"Марципан":{"name":"Марципан","type":"folder","children":{"-Катанчики КБ":{"name":"-Катанчики КБ","type":"item","children":{}},"-Марципановый батончик в молочном шоколаде КБ":{"name":"-Марципановый батончик в молочном шоколаде КБ","type":"item","children":{}},"-Марципановый батончик КБ":{"name":"-Марципановый батончик КБ","type":"item","children":{}}}},"Пироги заказные":{"name":"Пироги заказные","type":"folder","children":{"-Пирог с картофелем и грибами КБ":{"name":"-Пирог с картофелем и грибами КБ","type":"item","children":{}},"-Пирог с курицей КБ":{"name":"-Пирог с курицей КБ","type":"item","children":{}}}},"Сертификат/Бонус":{"name":"Сертификат/Бонус","type":"folder","children":{"-Подарочный сертификат 1000 ₽  КБ":{"name":"-Подарочный сертификат 1000 ₽  КБ","type":"item","children":{}},"-Подарочный сертификат 1500 ₽  КБ":{"name":"-Подарочный сертификат 1500 ₽  КБ","type":"item","children":{}},"-Подарочный сертификат 2000 ₽  КБ":{"name":"-Подарочный сертификат 2000 ₽  КБ","type":"item","children":{}},"-Подарочный сертификат 3000 ₽  КБ":{"name":"-Подарочный сертификат 3000 ₽  КБ","type":"item","children":{}},"-Подарочный сертификат 500 ₽  КБ":{"name":"-Подарочный сертификат 500 ₽  КБ","type":"item","children":{}},"Регистрация бонусной карты КБ":{"name":"Регистрация бонусной карты КБ","type":"item","children":{}},"-В свою кружку - 10%  КБ":{"name":"-В свою кружку - 10%  КБ","type":"item","children":{}}}},"Сувениры":{"name":"Сувениры","type":"folder","children":{"Свеча соевая «Konigsbacker»":{"name":"Свеча соевая «Konigsbacker»","type":"item","children":{}},"Свеча соевая «Булочка с корицей»":{"name":"Свеча соевая «Булочка с корицей»","type":"item","children":{}},"Свеча соевая «Латте имбирный пряник»":{"name":"Свеча соевая «Латте имбирный пряник»","type":"item","children":{}},"Стикерпак КБ":{"name":"Стикерпак КБ","type":"item","children":{}},"Сувенир керамический \"Отдыхающий тюлень\"":{"name":"Сувенир керамический \"Отдыхающий тюлень\"","type":"item","children":{}},"Сувенир керамический \"Спящий тюлень\"":{"name":"Сувенир керамический \"Спящий тюлень\"","type":"item","children":{}},"Сувенир керамический \"Тюлененок\"":{"name":"Сувенир керамический \"Тюлененок\"","type":"item","children":{}},"Тарелка фарфор цветная 16 см":{"name":"Тарелка фарфор цветная 16 см","type":"item","children":{}},"Тарелка фарфор цветная 20,5 см":{"name":"Тарелка фарфор цветная 20,5 см","type":"item","children":{}},"Чаша фарфор цветная 16см, 460 мл":{"name":"Чаша фарфор цветная 16см, 460 мл","type":"item","children":{}},"Чашка фарфор цветная 180мл":{"name":"Чашка фарфор цветная 180мл","type":"item","children":{}},"Чашка фарфор цветная 280мл":{"name":"Чашка фарфор цветная 280мл","type":"item","children":{}}}},"Торты на заказ":{"name":"Торты на заказ","type":"folder","children":{"-Торт на заказ весовой без декора, 1 кг КБ":{"name":"-Торт на заказ весовой без декора, 1 кг КБ","type":"item","children":{}},"-Торт на заказ весовой с декором, 1 кг КБ":{"name":"-Торт на заказ весовой с декором, 1 кг КБ","type":"item","children":{}}}}}},"Праздники":{"name":"Праздники","type":"folder","children":{"Ассортимент 1 сентября":{"name":"Ассортимент 1 сентября","type":"folder","children":{}},"Ассортимент 14 февраля":{"name":"Ассортимент 14 февраля","type":"folder","children":{}},"Ассортимент 23 февраля":{"name":"Ассортимент 23 февраля","type":"folder","children":{}},"Ассортимент 8 марта":{"name":"Ассортимент 8 марта","type":"folder","children":{}},"Ассортимент Новый год":{"name":"Ассортимент Новый год","type":"folder","children":{}},"Пасхальный ассортимент":{"name":"Пасхальный ассортимент","type":"folder","children":{}}}}};
</script></head>

<body>

<header>UX-тест навигации ассортимента</header>

<div class="controls">
  <input type="text" id="employeeName" placeholder="Имя сотрудника">
  <input type="file" id="fileInput" accept=".xlsx,.xls">

  <button onclick="goBack()">Назад</button>
  <button onclick="goHome()">В главное меню</button>
  <button onclick="startSmartTest()">Начать тест</button>

  <button id="btnStandalone" onclick="exportStandalone()">⬇️ Standalone</button>
</div>

<div class="test-box" id="testBox" style="display:none"></div>
<div class="alert-wrong" id="wrongBox" style="display:none">❌ Неправильно</div>

<div class="path" id="path">📁 </div>
<div class="container" id="container"><div class="item folder">📁 Сладкая</div><div class="item folder">📁 Кондитерка</div><div class="item folder">📁 Сытная</div><div class="item folder">📁 Ланчи/Завтраки</div><div class="item folder">📁 Напитки</div><div class="item folder">📁 Хлеб</div><div class="item folder">📁 Упаковка</div><div class="item folder">📁 Доп/Поз</div><div class="item folder">📁 Пачка/Кофе</div><div class="item folder">📁 Сувениры/Услуги/Заказы</div><div class="item folder">📁 Праздники</div></div>
<div id="resultScreen" style="display:none"></div>

<script>
/* ================= GOOGLE SHEETS ================= */
const GOOGLE_WEBHOOK_URL =
'https://script.google.com/macros/s/AKfycbzKP_jvXCgXWegqGrFWQNGEdcW1hItsFPxozcElLHtlTPf4Eg_jpU4B68JsybJboxi_BQ/exec';

function sendResultsToGoogle(results){
  fetch(GOOGLE_WEBHOOK_URL,{
    method:'POST',
    mode:'no-cors',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify(results)
  });
}

/* ================= DATA / MODE ================= */
let tree = {};
let currentPath = [];

const IS_STANDALONE =
  typeof __STANDALONE_TREE__ !== 'undefined';

/* ================= INIT STANDALONE ================= */
if (IS_STANDALONE) {
  tree = __STANDALONE_TREE__;
  document.addEventListener('DOMContentLoaded', () => {
    const fi = document.getElementById('fileInput');
    const bs = document.getElementById('btnStandalone');
    if (fi) fi.style.display = 'none';
    if (bs) bs.style.display = 'none';
    render();
  });
}

/* ================= STATE ================= */
let employee='';
let testItems=[];
let testIndex=0;
let testClicks=0;
let activeTarget=null;
let lastRunResults=[];

/* ================= LOAD EXCEL (ADMIN) ================= */
const fileInput = document.getElementById('fileInput');
if (fileInput) {
  fileInput.addEventListener('change', loadExcel);
}

function loadExcel(e){
  const reader = new FileReader();
  reader.onload = ev => {
    const wb = XLSX.read(ev.target.result, { type: 'binary' });
    const rows = XLSX.utils.sheet_to_json(
      wb.Sheets[wb.SheetNames[0]], { header: 1 }
    );

    tree = {};
    const stack = [];

    rows.slice(1).forEach(r => {
      const [lvl, type, name] = r;
      if (!lvl || !type || !name) return;

      const node = { name, type, children: {} };
      stack[lvl - 1] = node;
      stack.length = lvl;

      if (lvl === 1) tree[name] = node;
      else if (stack[lvl - 2]?.type === 'folder') {
        stack[lvl - 2].children[name] = node;
      }
    });

    currentPath = [];
    render();
  };

  reader.readAsBinaryString(e.target.files[0]);
}

/* ================= NAV ================= */
function getNode(){
  return currentPath.reduce((n,k)=>n.children[k],{children:tree});
}

function render(){
  document.getElementById('resultScreen').style.display='none';
  const c=document.getElementById('container');
  const p=document.getElementById('path');
  c.innerHTML='';
  p.innerHTML='📁 '+currentPath
    .map((x,i)=>`<span onclick="goTo(${i})">${x}</span>`)
    .join(' / ');

  Object.values(getNode().children).forEach(ch=>{
    const d=document.createElement('div');
    d.className='item '+(ch.type==='folder'?'folder':'product');
    d.textContent=ch.type==='folder'?'📁 '+ch.name:ch.name;

    if(ch.type==='folder'){
      d.onclick=()=>{
        currentPath.push(ch.name);
        if(activeTarget) testClicks++;
        render();
      };
    } else {
      d.onclick=()=>onProductClick(ch.name);
    }
    c.appendChild(d);
  });
}

function goTo(i){currentPath=currentPath.slice(0,i+1);if(activeTarget) testClicks++;render();}
function goBack(){if(currentPath.length){currentPath.pop();if(activeTarget) testClicks++;render();}}
function goHome(){currentPath=[];if(activeTarget) testClicks++;render();}

/* ================= FILTER ITEMS ================= */
/* ❌ Ланчи/Завтраки и ❌ Доп/Поз полностью исключены */
function collectItems(node, path = [], res = []) {
  Object.values(node).forEach(n => {
    const p = [...path, n.name];

    if (p[0] === 'Ланчи/Завтраки') return;
    if (p.includes('Доп/Поз')) return;

    if (n.type === 'item') {
      res.push({
        name: n.name,
        type: 'item',
        steps: p.length - 1,
        section: p[0]
      });
    }

    if (n.children) {
      collectItems(n.children, p, res);
    }
  });
  return res;
}

/* ================= TEST ================= */
function startSmartTest(){
  employee=document.getElementById('employeeName').value.trim();
  if(!employee) return alert('Введите имя сотрудника');

  const all=collectItems(tree);
  if(all.length<5) return alert('Недостаточно позиций');

  lastRunResults=[];
  testItems=all.sort(()=>0.5-Math.random()).slice(0,5);
  testIndex=0;
  nextTestItem();
}

function nextTestItem(){
  if(testIndex>=testItems.length) return showResultScreen();

  activeTarget=testItems[testIndex];
  testClicks=0;
  currentPath=[];
  document.getElementById('wrongBox').style.display='none';
  render();

  document.getElementById('testBox').style.display='block';
  document.getElementById('testBox').innerHTML=
    `<b>${employee}</b><br>Найдите: <b>${activeTarget.name}</b><br>Эталон: ${activeTarget.steps}`;
}

function onProductClick(name){
  if(!activeTarget) return;
  const success=name===activeTarget.name;
  if(!success)
    document.getElementById('wrongBox').style.display='block';
  finishTarget(success);
}

function finishTarget(success){
  const exp=activeTarget.steps;
  const actual=testClicks;

  lastRunResults.push({
    employee,
    product:activeTarget.name,
    section:activeTarget.section,
    expected:exp,
    actual:actual,
    delta:actual-exp,
    kpiOk: success && actual<=exp+1
  });

  testIndex++;
  setTimeout(nextTestItem,600);
}

/* ================= RESULT ================= */
function showResultScreen(){
  document.getElementById('container').innerHTML='';
  document.getElementById('path').innerHTML='';
  document.getElementById('testBox').style.display='none';

  const d=document.getElementById('resultScreen');
  d.style.display='block';

  let h=`<h3>Результаты теста</h3><table><tr>
  <th>Сотрудник</th><th>Товар</th><th>Раздел</th>
  <th>Эталон</th><th>Факт</th><th>Отклонение</th><th>KPI OK</th></tr>`;

  lastRunResults.forEach(r=>{
    h+=`<tr>
      <td>${r.employee}</td>
      <td>${r.product}</td>
      <td>${r.section}</td>
      <td>${r.expected}</td>
      <td>${r.actual}</td>
      <td>${r.delta}</td>
      <td class="${r.kpiOk?'kpi-ok':'kpi-fail'}">${r.kpiOk?'Да':'Нет'}</td>
    </tr>`;
  });

  h+=`</table><br>
  <button onclick="startSmartTest()">Пройти ещё раз</button>
  <button onclick="goHome()">В главное меню</button>`;

  d.innerHTML=h;

  sendResultsToGoogle(lastRunResults);
}

/* ================= STANDALONE EXPORT ================= */
function exportStandalone(){
  if(!Object.keys(tree).length){
    alert('Сначала загрузите Excel');
    return;
  }

  let html=document.documentElement.outerHTML;
  const inject=`<script>
const __STANDALONE_TREE__=${JSON.stringify(tree)};
<\/script>`;
  html=html.replace('</head>',inject+'</head>');

  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([html],{type:'text/html'}));
  a.download='ux_test_standalone.html';
  a.click();
}
</script>



</body></html>